<div class="max-w-xl mx-auto mt-8 px-7 py-8">
  <div class="mb-8">
    <h1 class="text-4xl font-bold">Scan a Card</h1>
    <p class="text-gray-600 mt-1">Take a photo of a Magic card to identify it and add it to your collection.</p>
  </div>

  <%= form_with url: scans_path, method: :post, multipart: true, class: "space-y-6" do |f| %>
    <div class="bg-white border-2 border-gray-200 rounded-xl p-6">
      <label class="block cursor-pointer">
        <div id="preview-container" class="w-full aspect-[3/4] bg-gray-100 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden">
          <div id="placeholder" class="text-center p-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <p class="text-gray-500 font-semibold mt-2">Tap to take a photo</p>
            <p class="text-gray-400 text-sm mt-1">or choose from gallery</p>
          </div>
          <img id="preview-image" class="hidden w-full h-full object-cover rounded-xl" />
        </div>

        <%= f.file_field :image,
            accept: "image/*",
            capture: "environment",
            class: "hidden",
            onchange: "previewImage(event)" %>
      </label>
    </div>

    <%= f.submit "Identify Card",
        class: "w-full bg-umber hover:bg-golden-brown text-white py-3 rounded-xl font-semibold transition-colors cursor-pointer" %>
  <% end %>
</div>

<script>
  function previewImage(event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('preview-image').src = e.target.result;
        document.getElementById('preview-image').classList.remove('hidden');
        document.getElementById('placeholder').classList.add('hidden');
      };
      reader.readAsDataURL(file);
    }
  }
</script>
