<div class="max-w-xl mx-auto mt-4 px-4 py-4"
    data-controller="card-scanner"
    data-card-scanner-match-url-value="<%= match_cards_path %>">

  <div class="mb-4">
    <h1 class="text-3xl font-bold">Scan a Card</h1>
    <p class="text-gray-600 text-sm mt-1">Point your camera at the card name.</p>
  </div>

  <!-- Camera Feed -->
  <div class="relative bg-black rounded-2xl overflow-hidden shadow-xl mb-4">
    <video data-card-scanner-target="video"
          autoplay playsinline muted
          class="w-full rounded-2xl"></video>

    <!-- Guide overlay - title region -->
    <div class="absolute inset-0 pointer-events-none">
      <!-- Darkened areas -->
      <div class="absolute top-0 left-0 right-0 h-[5%] bg-black/40"></div>
      <div class="absolute top-[20%] left-0 right-0 bottom-0 bg-black/40"></div>
      <div class="absolute top-[5%] left-0 w-[10%] h-[15%] bg-black/40"></div>
      <div class="absolute top-[5%] right-0 w-[10%] h-[15%] bg-black/40"></div>

      <!-- Clear window with border -->
      <div class="absolute top-[5%] left-[10%] right-[10%] h-[15%] border-2 border-goldenrod rounded-lg">
        <span class="absolute -top-5 left-2 text-xs text-goldenrod font-semibold bg-black/60 px-2 py-0.5 rounded">
          Card Name
        </span>
      </div>
    </div>
  </div>

  <!-- Hidden canvas for processing -->
  <canvas data-card-scanner-target="canvas" class="hidden"></canvas>

  <!-- Status -->
  <div data-card-scanner-target="status"
      class="text-center text-sm font-semibold text-gray-500 mb-4 transition-colors">
    Starting camera...
  </div>

  <!-- Results -->
  <div data-card-scanner-target="results" class="space-y-2"></div>

  <!-- Fallback -->
  <div class="mt-6 pt-4 border-t border-gray-200">
    <p class="text-center text-sm text-gray-400 mb-3">Or search manually</p>
    <%= form_with url: search_cards_path, method: :get, class: "flex gap-2" do |f| %>
      <%= f.text_field :q,
          placeholder: "Type card name...",
          class: "flex-1 px-4 py-2 border-2 border-gray-200 rounded-xl focus:border-umber focus:outline-none text-sm" %>
      <%= f.submit "Search",
          class: "bg-umber hover:bg-golden-brown text-white px-4 py-2 rounded-xl font-semibold text-sm transition-colors cursor-pointer" %>
    <% end %>
  </div>
</div>
